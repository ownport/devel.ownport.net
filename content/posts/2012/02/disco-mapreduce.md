Title: Disco - mapreduce для распределенных вычислений
Author: d.rey
Date: 2012-02-19 13:50:00
Slug: disco-mapreduce
Tags: server,nokia,cluster,erlang,mapreduce,python,processing,computing

[Disco](http://discoproject.org/) - это реализация [технологии MapReduce](http://en.wikipedia.org/wiki/MapReduce) для распределенный вычислений. Disco поддерживает выполнение параллельных вычислений большого объема данных, сохраненных на обычных компьютерах, включенных в кластер, реализуя идеи Google MapReduce, описанные в документе [MapReduce: Simplified Data Processing on Large Clusters](http://research.google.com/archive/mapreduce.html). Это делает Disco отличным решением для анализа и обработки больших объемов данных, не требующем дополнительных знаний в таких сложных распределенных технологиях как протоколы коммуникации, балансировка нагрузки, блокировка, распределения задач, отказоустойчивость. 

Disco может быть использован для различных задач сбора, анализа данных, построения сложных вероятностных моделей, полнотекстовой индексации web-данных. И это лишь небольшой список примеров применения.

Ядро Disco написано на [Erlang](http://www.erlang.org/) - языке программирования, разработанным специально для построения масштабируемых программных систем реального времени требующих высокой доступности. Пользователи Disco обычно пишут свои задачи на Python, позволяющем описывать сложные алгоритмы небольшим и легко читаемым кодом.

Ниже приведен рабочий пример кода для подсчета частоты использования слов в большом тексте.

    :::python
    from disco.core import Job, result_iterator

    def map(line, params):
        for word in line.split():
            yield word, 1
    
    def reduce(iter, params):
        from disco.util import kvgroup
        for word, counts in kvgroup(sorted(iter)):
            yield word, sum(counts)
    
    if __name__ == '__main__':
        job = Job().run(input=["http://discoproject.org/media/text/chekhov.txt"],
                        map=map,
                        reduce=reduce)
        for word, count in result_iterator(job.wait(show=True)):
            print word, count
            
Дизайн Disco направлен на упрощение интеграции его в большие приложения, такие как web-сервисы. Существует возможность реализовать делегирование сложных вычислительных задач кластеру независимо от работы основного приложения.  Disco предоставляет невероятно компактный Python API: как правило только две функции необходимы, map и reduce.  REST Web API используется для управления задачами и web-интерфейса для мониторинга статуса работы системы.

Disco хорошо подходит для развертывания кластеров, построенных на основе обычных Linux серверов. Новая нода может быть добавлена в систему на лету, одним кликом через web-интерфейс. Если одна из нод выходит из строя, активные задачи автоматически перераспределяются между другими нодами без прерывания работы системы. Совместно с системой автоматической инсталляции [FAI](http://fai-project.org/) даже большие кластеры могут поддерживаться с минимальным количеством ручной работы. В качестве доказательства концепции, [Центр разработки компании Nokia в Palo Alto](http://research.nokia.com/) обслуживает таким образом 800-ядерный Disco кластер.

**Основные функциональности Disco**

- Масштабируемость на сотни процессоров и десятки тысяч параллельных задач
- Используется для обработки наборов данных в десятки терабайт
- Прост в использовании: обычные задачи содержат только две функции, написанные на python и два вызова к Disco API
- Задачи могут быть адаптированы под любой язык программирования через простой внешний интерфейс, базирующийся на стандартных потоках ввода-вывода.
- Входные данные могут быть представлены в любом формате, даже бинарные данные, такие как изображения. Данные могут быть размещены на любых ресурсах доступных через HTTP протокол или могут быть распределены на локальных дисках.
- Отказоустойчивость: выход из строя ноды не приводит к прерыванию выполнения задач. Новые сервера могут быть добавлены на лету.
- В дополнении к функциям map и reduce, есть дополнительно функции combiner и partitioner, а также функция input reader.
- Легкость интеграции в большие приложения используя Disco модули и Web API
- Поставляется со встроенной распределенной системой хранения [Disco Distributed Filesystem](http://discoproject.org/doc/howto/ddfs.html#ddfs) и распределенной индексной подсистемой [Discodex](http://discoproject.org/doc/contrib/discodex/discodex.html#discodex), позволяющей выполнять специальные запросы к терабайтным данным

